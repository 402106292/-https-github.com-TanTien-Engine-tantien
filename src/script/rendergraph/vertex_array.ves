import "render" for VertexArray as r_VertexArray
import "blueprint.node" for Node
import "blueprint.pin" for Pin

class VertexArray is Node
{
	init() 
	{
		super.init(VertexArray.name)

		this.exports = [
			Pin(this, "out", "va")
		]
		this.layout()

		this.data = nil
		this.attrs = nil

		this.ibuf = nil

		this.va = nil
		this.dirty = true
	}

	execute() {
		if (this.data and this.attrs and this.dirty) {
			this.va = r_VertexArray.init(this.data, this.attrs, this.ibuf)
			this.dirty = false
		}
	}

	toString(name) 
	{
		var ret = "
%(name).data = %(this.data)
%(name).attrs = %(this.attrs)
"
		if (this.ibuf) {
			ret = ret + "
%(name).ibuf = %(this.ibuf)
"
		}
		return ret
	}
}